---
- hosts: localhost
  connection: local

  roles:
    # Set up tooling
    - { role: homebrew, tags: ["base"] }
    - { role: ansible, tags: ["base"] }

    # Configure terminal applications
    - { role: ssh, tags: ["terminal"] }
    - { role: shell, tags: ["terminal"] }
    - { role: neovim, tags: ["terminal"] }
    - { role: git, tags: ["terminal", "dev"] }

    # Install programming languages and tools
    - { role: aws, tags: ["terminal", "dev"] }
    - { role: php, tags: ["terminal", "dev"] }
    - { role: python, tags: ["terminal", "dev", "python"] }
    - { role: ruby, tags: ["terminal", "dev", "ruby"] }
    - { role: rust, tags: ["terminal", "dev"] }
    - { role: terraform, tags: ["terminal", "dev"] }

    # Install applications
    - { role: software, tags: ["workstation"] }

  tasks:
    - name: Manage Git repositories
      ansible.builtin.include_role:
        name: repository
      tags: ["terminal", "workstation", "dev"]
      vars:
        project: "{{ project_item }}"
      loop_control:
        loop_var: project_item
      loop: "{{ repositories }}"
